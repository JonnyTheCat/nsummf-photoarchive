{% extends 'main.html' %}

{% block content %}

<h1 class="mb-4">Загрузка фотографий</h1>

<form method="post">
    <div class="row">
        <div class="col-7">
            <div>
                <div class="row">
                    <div class="col">
                        <div class="mb-3">
                            <input type="text" class="form-control" id="AuthorName" placeholder="Автор" disabled>
                        </div>
                    </div>
                    <div class="col-2 mb-3">
                        <input type="number" class="form-control" id="Day" placeholder="День" disabled>
                    </div>
                    <div class="col-2 mb-3">
                        <input type="number" class="form-control" id="Month" placeholder="Месяц" disabled>
                    </div>
                    <div class="col-2 mb-3">
                        <input type="number" class="form-control" id="Year" placeholder="Год" disabled>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <div class="mb-3 form-check">
                            <input type="checkbox" id="SameAuthor" class="form-check-input" id="" disabled>
                            <label class="form-check-label" for="exampleCheck1">Общий автор</label>
                        </div>
                    </div>
                    <div class="col">
                        <div class="mb-3 form-check">
                            <input type="checkbox" id="SameDate" class="form-check-input" id="" disabled>
                            <label class="form-check-label" for="exampleCheck1">Общая дата</label>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col mb-3">
                        <textarea class="form-control" id="Description" rows="5" placeholder="Описание (краткое)" disabled></textarea>
                    </div>
                </div>

                <div class="row">
                    <div class="col mb-5">
                        <button type="button" id="PreviousImageButton" class="btn btn-primary" onclick="prevImage();" disabled>Назад</button>
                    </div>
                    <div class="col mb-5">
                        <button type="button" id="NextImageButton" class="btn btn-primary float-end" onclick="nextImage();" disabled>Вперёд</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col mb-3">
                        <button type="button" id="Submit" class="btn btn-primary primary-color" onclick="submit();" disabled>Загрузить</button>
                        <button type="button" id="Reset" class="btn btn-danger" onclick="reset();" disabled>Сброс</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="row">
                <input type="file" id="ImagesInput" class="form-control" onchange="showImage();" accept="image/*" multiple>
            </div>
            <div class="row" id="PhotoViewBackground" style="background-color: #434242; border-radius: 10px;">
                <img class="img-fluid mb-3 mt-3" id="PhotoView" src="" alt="">
            </div>
        </div>
    </div>
</form>

<script>
    var currentImage = 1;
    var uploadedImages = 0;
    $('#PhotoViewBackground').hide();

    var reader = new FileReader();
    reader.onload = function (e) {
        $('#PhotoView')
            .attr('src', e.target.result)
            .attr('alt', 'PhotoPreview');
        $('#ImagesInput').hide();
        $('#PhotoViewBackground').show();
    };
    
    function showImage() {
        if (ImagesInput.files && ImagesInput.files[0]) {
            reader.readAsDataURL(ImagesInput.files[0]);
            uploadedImages = ImagesInput.files.length;


            $('#AuthorName').prop('disabled', false);
            $('#Day').prop('disabled', false);
            $('#Month').prop('disabled', false);
            $('#Year').prop('disabled', false);
            $('#SameAuthor').prop('disabled', false);
            $('#SameDate').prop('disabled', false);
            $('#Description').prop('disabled', false);
            $('#PreviousImageButton').prop('disabled', false);
            $('#NextImageButton').prop('disabled', false);
        }
    }

    function prevImage() {
        if (currentImage > 1) {
            currentImage = currentImage - 1;
            reader.readAsDataURL(ImagesInput.files[currentImage - 1]);
        }
    }

    function nextImage() {
        if (currentImage < uploadedImages ) {
            currentImage = currentImage + 1;
            reader.readAsDataURL(ImagesInput.files[currentImage - 1]);
        }
    }
</script>
{% endblock content %}